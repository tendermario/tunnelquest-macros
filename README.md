# Tunnelquest Macros

This is a hack-free system for EverQuest inventory management, designed for people that sell in the tunnel in EC.

Since the Bazaar exists in most version of EverQuest, this is primarily useful in Project1999 Blue/Green servers.

## How it works

This uses data out of raw eq inventory files and turns it into hotkey macros with purple links.

"Purple links" (in-message links to the item with details) are usually only able to be generated by ctrl + clicking on the image of an item. This only puts the item into the text field, and is not usually accessible to macros. There is [prior art][] to wedging a purple link into a macro, which involves editing your macros file.

This system currently requires pasting the output lines into your macros file.

## Instructions

1. Run in EverQuest `/exportfile inventory` on each character you want to export the inventory on. It's simplest to keep the whole inventory of a mule as sellable inventory.
2. Run Tunnelquest Macros.
3. Select the inventory files.
4. Select which items to skip (like backpacks)
5. Enter prices.
6. Copy the output list into your macros file.

## Reference Conversion

Input file(s) contents:

    Input: Tomnook-inventory.txt
    Slot Name  ID  Quantity
    Bag1 Gloves  0234  1
    Bag1-slot2 A cool sword  11113 1
    Bag1-slot2 Another sword  11114 1
    Bag1-slot2 A sword  11333 1
    Bag1-slot2 Gloves  1222 1
    ...

Output text to be pasted in your macros file:

    Page2Button5Line1=/auc WTS 002fe3000000000000000000000000000000000000000A cool sword | 002fe3000000000000000000000000000000000000000Another sword | 002fe3000000000000000000000000000000000000000A sword
    Page2Button5Line2=/auc WTS 002fe3000000000000000000000000000000000000000Gloves
    ...

## Goals

### 1.1.0

1. Turn this into an electron app
1. Add prices via another input field

### 1.0.0

1. For a given input list, create an output list
1. For an output list, modify it to have only the name and ID
1. For a name and ID, add purple link, ID hex and padding
1. For each purple link, add prefix and delimiter up to 255 characters separation
1. For each purple link list, add button prefix
1. Make sure each line is under 255 characters
1. Add a list of ignored items
1. Save data to local storage to remember previous price values
1. Fix bug: undefined items in list
1. Add a list of prices per items
1. Sort items (by name, or price)
1. Add loading from multiple files into input
1. Host at tendermario.github.io/eq-purple-links

### Next
1. Bugfix - not all values put into the prices area are numerically alphabetical
1. Add saving the same files selected to storage
1. Make tabbing to next price field possible - rearrange prices
1. Add some styling, maybe use stone UI?
1. Consider "2k" as "2000", consider "2.1k" as "2100"
1. Add an icon for the app

## Development

### Prerequisites

1. (WSL on Windows ONLY) install extra libraries:

```
sudo apt-get update && export DEBIAN_FRONTEND=noninteractive && sudo apt-get -y install --no-install-recommends xorg openbox libnss3 libasound2 libatk-adaptor libgtk-3-0
# For running the development electron, we need these libraries to launch in a window
sudo apt-get install -y curl unzip xvfb libxi6 libgconf-2-4
```

2. To clear error message "[6354:0128/152020.047105:ERROR:bus.cc(407)] Failed to connect to the bus: Failed to connect to socket /var/run/dbus/system_bus_socket: No such file or directory" run:

```
sudo service dbus start
```

2. fork this repo
3. Install dependencies `npm i`
4. Run the electron server `npm start`

### Building the distributable/executable for release

Electron normally can only build for Windows from a Windows system. I had some issues trying to figure out how to acheive that, so I am using `electron-builder` as it promises to be able to build for Windows from a Mac computer.

To build for mac and windows, run `npm run dist` which builds to `dist` a `.dmg` Mac installer file and a Windows `.exe` file, and to `dist/mac-arm64` a `.app` file.
